apiVersion: build.knative.dev/v1alpha1
kind: BuildTemplate
metadata:
  name: openwhisk-nodejs-runtime
spec:
  parameters:
  - name: IMAGE
    description: name of the image to be tagged and pushed
  - name: DOCKERFILE
    description: name of the dockerfile
  - name: __OW_DEBUG
    description: flag to indicate debug mode should be on/off
    default: "false"
  steps:
  - name: dockerfile
    image: "gcr.io/kaniko-project/executor:debug"
    command:
    - /busybox/sh
    args:
    - -c
    - echo "ENV __OW_DEBUG ${__OW_DEBUG}" >> ${DOCKERFILE}
  - name: build-and-push
    image: "gcr.io/kaniko-project/executor:v0.6.0"
    args: ["--destination=${IMAGE}", "--dockerfile=${DOCKERFILE}"]
